<ion-header>
  <ion-navbar>
    <bm-header></bm-header>
  </ion-navbar>
</ion-header>
<ion-content>
  <div class="background-image">
    <img src="{{event.cover_photo_url}}" alt="Perfil Header"/>
  </div>
  <div class="main-content">
    <ion-item>
      <ion-avatar item-left class="ion-avatar-event">
        <h2 class="h2-events-avatar">{{ event.event_date | date:'dd'}}</h2>
        <h3 class="h3-events-avatar">{{ event.event_date | date:'MMM'}}</h3>
      </ion-avatar>
      <h2>{{event.name}}</h2>
      <p>{{event.created_at | date:'MMMM d, y'}}</p>
    </ion-item>
    <ion-item>
      <p>
        {{event.about}}
      </p>
    </ion-item>
    <p>
      {{event.address.street + " " + event.address.complement + ", " + event.address.neighborhood + ", " + event.city.name + " - " + event.state.name}}
    </p>
    <ion-card>
      <a ion-item (click)="openPostModal()">
        <ion-avatar item-left>
          <img src="{{user.avatar_url}}" id='user_avatar'>
        </ion-avatar>
        <p>
          Digite alguma coisa...
        </p>
      </a>
    </ion-card>
    <ion-row [hidden]="!showAdminActions">
      <ion-col width-33>
        <button ion-button outline block color="light" (click)="openModal(eventGuests, friends)" icon-left>
          Convidar
        </button>
      </ion-col>
    </ion-row>
    <ion-row [hidden]="!showGuestActions">
      <ion-col width-50>
        <button ng-disabled="buttonStatus" block ion-button outline color="light" (click)="refuse_event()" icon-left>
          NÃ£o vou
        </button>
      </ion-col>
      <ion-col width-50>
        <button ion-button outline block color="light" (click)="accept_event()" icon-left>
          Vou
        </button>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col width-33>
        <a (click)="openModal(eventGuests, confirmedGuests)">
          <h2>{{l_confirmedGuests}}</h2>
        </a>
        <p>
          Confirmaram
        </p>
      </ion-col>
      <ion-col width-33>
        <a (click)="openModal(eventGuests, allGuests)">
          <h2>{{l_allGuests}}</h2>
        </a>
        <p>
          Convidados
        </p>
      </ion-col>
      <ion-col width-33>
        <a (click)="openModal(eventGuests, pendingGuests)">
          <h2>{{l_pendingGuests}}</h2>
        </a>
        <p>
          Pendentes
        </p>
      </ion-col>
    </ion-row>
    <ion-card *ngFor="let post of posts">
      <ion-item>
        <ion-avatar item-left (click)='openProfile(post.user.user_id)'>
          <img src="{{post.user.avatar_url}}"/>
        </ion-avatar>
        <h2 (click)='openProfile(post.user.user_id)'>{{post.user.name}}</h2>
        <p>{{post.sent_date_format}}</p>
      </ion-item>
      <ion-card-content>
        <p>{{post.description}}</p>
        <div class="post-images" *ngIf="post.post_images">
          <div class="post-image" *ngFor="let image of post.post_images; let i = index">
            <img src="{{image.post_image}}" *ngIf='i < 4' alt="" />
          </div>
        </div>
      </ion-card-content>
      <ion-row>
        <ion-col width-25>
          <div class="badges-container">
            <ion-badge item-left small *ngIf='post.likes.size > 0'>{{post.likes.size}}</ion-badge>
          </div>
          <button class='like-action' ion-button icon-left clear small (click)='like(post)'>
            <ion-icon ios="ios-thumbs-up" md="md-thumbs-up" [color]="like_color_for(post)"></ion-icon>
          </button>
        </ion-col>
        <ion-col width-25>
          <div class="badges-container">
            <ion-badge item-left small *ngIf='post.comments.length > 0'>{{post.comments.length}}</ion-badge>
          </div>
          <button ion-button icon-left clear small (click)='post.showComments = !post.showComments'>
            <ion-icon ios="ios-text" md="md-text" color="barramais"></ion-icon>
          </button>
        </ion-col>
        <ion-col width-25>
          <div class="badges-container">
          </div>
          <button ion-button icon-left clear small>
            <ion-icon ios="ios-share" md="md-share" color="grayed"></ion-icon>
          </button>
        </ion-col>
      </ion-row>
      <div *ngIf="post.showComments">
        <div class="post-comments" *ngFor='let comment of post.comments'>
          <ion-item>
            <ion-avatar item-left (click)='openProfile(comment.commentator.user_id)'>
              <img src="{{comment.commentator.avatar_url}}">
            </ion-avatar>
            <h2 (click)='openProfile(comment.commentator.user_id)'>{{comment.commentator.name}}</h2>
            <p>{{comment.sent_date_format}}</p>
          </ion-item>
          <ion-card-content>
            <p>{{comment.body}}</p>
          </ion-card-content>
        </div>
      </div>
      <ion-grid class='formgrid'>
        <!-- <ion-row> -->
          <!-- <ion-col width-80> -->
          <ion-item class="item-comment">
            <ion-textarea placeholder='Comentar..' [(ngModel)]="post.new_comment_body"></ion-textarea>
          <!-- </ion-col>
          <ion-col> -->
            <button class="send-comment-button" item-right icon-button ion-button color="primary" (click)="createComment(post, post.new_comment_body)">
              <ion-icon name="send"></ion-icon>
            </button>
          </ion-item>

          <!-- </ion-col>
        </ion-row> -->
      </ion-grid>
    </ion-card>
  </div>
</ion-content>
